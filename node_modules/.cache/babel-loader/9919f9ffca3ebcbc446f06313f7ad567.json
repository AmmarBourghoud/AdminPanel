{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\abourgho\\\\Desktop\\\\ETNA\\\\GPE\\\\group-690338\\\\AdminPanel\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\abourgho\\\\Desktop\\\\ETNA\\\\GPE\\\\group-690338\\\\AdminPanel\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\abourgho\\\\Desktop\\\\ETNA\\\\GPE\\\\group-690338\\\\AdminPanel\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\abourgho\\\\Desktop\\\\ETNA\\\\GPE\\\\group-690338\\\\AdminPanel\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _inherits from \"C:\\\\Users\\\\abourgho\\\\Desktop\\\\ETNA\\\\GPE\\\\group-690338\\\\AdminPanel\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:\\\\Users\\\\abourgho\\\\Desktop\\\\ETNA\\\\GPE\\\\group-690338\\\\AdminPanel\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"C:\\\\Users\\\\abourgho\\\\Desktop\\\\ETNA\\\\GPE\\\\group-690338\\\\AdminPanel\\\\src\\\\views\\\\Signals\\\\SignalsMap.js\";\nimport React, { Component } from 'react';\nimport { Badge, Card, CardBody, CardHeader, Col, Row, Table } from 'reactstrap';\nimport wretch from 'wretch';\nimport Moment from 'moment';\nimport mapboxgl from 'mapbox-gl';\nimport { relative } from 'path';\n\nvar SignalsMap = /*#__PURE__*/function (_Component) {\n  _inherits(SignalsMap, _Component);\n\n  var _super = _createSuper(SignalsMap);\n\n  function SignalsMap(props) {\n    var _this;\n\n    _classCallCheck(this, SignalsMap);\n\n    _this = _super.call(this, props);\n    _this._isMounted = false;\n    _this.loadSignal = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n                if (_this._isMounted) _this.setState({\n                  isLoading: true\n                });\n                wretch().auth(\"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZGI4MTIzOWRmN2U2ZDRiNjgwZjQyZTEiLCJpYXQiOjE2MDA3Nzk3ODZ9.pmNOT1kl1a-ylGCOudg8JVabUOAuW3gRjuh2zSCmruQ\").url(\"http://localhost:8080/signal\").get().json(function (res) {\n                  if (_this._isMounted) _this.setState({\n                    isLoading: false,\n                    items: res\n                  });\n                  resolve(res);\n                }).catch(function (err) {\n                  console.log('err', err);\n                  reject();\n                });\n              }));\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    _this.state = {\n      items: {},\n      isLoading: false\n    };\n    return _this;\n  }\n\n  _createClass(SignalsMap, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var res, map;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                this._isMounted = true;\n                _context3.next = 3;\n                return this.loadSignal();\n\n              case 3:\n                res = _context3.sent;\n                mapboxgl.accessToken = 'pk.eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZGI4MTIzOWRmN2U2ZDRiNjgwZjQyZTEiLCJpYXQiOjE2MDA3Nzk3ODZ9.pmNOT1kl1a-ylGCOudg8JVabUOAuW3gRjuh2zSCmruQ';\n                map = new mapboxgl.Map({\n                  container: this.Mapcontainer,\n                  style: 'mapbox://styles/mapbox/streets-v9',\n                  center: [2.4159, 48.7651],\n                  zoom: 13\n                });\n                map.on(\"load\", function () {\n                  map.loadImage(\"https://i.imgur.com/MK4NUzI.png\", /*#__PURE__*/function () {\n                    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(error, image) {\n                      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                        while (1) {\n                          switch (_context2.prev = _context2.next) {\n                            case 0:\n                              if (!error) {\n                                _context2.next = 2;\n                                break;\n                              }\n\n                              throw error;\n\n                            case 2:\n                              _context2.next = 4;\n                              return res.forEach(function (sig) {\n                                map.addImage(sig._id, image);\n                                map.addLayer({\n                                  id: sig._id,\n                                  type: \"symbol\",\n                                  source: {\n                                    type: \"geojson\",\n                                    data: {\n                                      type: 'FeatureCollection',\n                                      features: [{\n                                        type: 'Feature',\n                                        properties: {\n                                          \"description\": \"<strong>\" + sig.name + \"</strong><p>\" + sig.description + \"</p> <p>Date: \" + Moment(sig.created_date).format('DD/MM/YY Ã  HH:mm') + \"</p> <p><a href='\" + \"/signal/\".concat(sig._id, \"/\") + \"'><em>Voir la fiche du signalement</em></a> </p>\"\n                                        },\n                                        geometry: {\n                                          type: \"Point\",\n                                          coordinates: [sig.localization.long, sig.localization.lat]\n                                        }\n                                      }]\n                                    }\n                                  },\n                                  layout: {\n                                    \"icon-image\": sig._id,\n                                    \"icon-allow-overlap\": true\n                                  }\n                                });\n                                map.on('click', sig._id, function (e) {\n                                  var coordinates = e.features[0].geometry.coordinates.slice();\n                                  var description = e.features[0].properties.description;\n\n                                  while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {\n                                    coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;\n                                  }\n\n                                  new mapboxgl.Popup().setLngLat(coordinates).setHTML(description).addTo(map);\n                                });\n                              });\n\n                            case 4:\n                            case \"end\":\n                              return _context2.stop();\n                          }\n                        }\n                      }, _callee2);\n                    }));\n\n                    return function (_x, _x2) {\n                      return _ref2.apply(this, arguments);\n                    };\n                  }());\n                });\n\n              case 7:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this._isMounted = false;\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function () {\n      var _componentDidUpdate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(prevProps, prevState, snapshot) {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (!(prevProps.match.params.id !== this.props.match.params.id)) {\n                  _context4.next = 3;\n                  break;\n                }\n\n                _context4.next = 3;\n                return this.loadSignal();\n\n              case 3:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function componentDidUpdate(_x3, _x4, _x5) {\n        return _componentDidUpdate.apply(this, arguments);\n      }\n\n      return componentDidUpdate;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"animated fadeIn\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Col, {\n        lg: 12,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Card, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(CardHeader, {\n        className: \"card card-accent-warning mb-3\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"strong\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"icon-info pr-1\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 25\n        }\n      }), \"Localisation\")), /*#__PURE__*/React.createElement(CardBody, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"FullMap\",\n        ref: function ref(x) {\n          _this2.Mapcontainer = x;\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 15\n        }\n      }))))));\n    }\n  }]);\n\n  return SignalsMap;\n}(Component);\n\nexport default SignalsMap;","map":{"version":3,"sources":["C:/Users/abourgho/Desktop/ETNA/GPE/group-690338/AdminPanel/src/views/Signals/SignalsMap.js"],"names":["React","Component","Badge","Card","CardBody","CardHeader","Col","Row","Table","wretch","Moment","mapboxgl","relative","SignalsMap","props","_isMounted","loadSignal","Promise","resolve","reject","setState","isLoading","auth","url","get","json","res","items","catch","err","console","log","state","accessToken","map","Map","container","Mapcontainer","style","center","zoom","on","loadImage","error","image","forEach","sig","addImage","_id","addLayer","id","type","source","data","features","properties","name","description","created_date","format","geometry","coordinates","localization","long","lat","layout","e","slice","Math","abs","lngLat","lng","Popup","setLngLat","setHTML","addTo","prevProps","prevState","snapshot","match","params","x"],"mappings":"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","sourcesContent":["\r\nimport React, { Component } from 'react';\r\nimport {Badge, Card, CardBody, CardHeader, Col, Row, Table} from 'reactstrap';\r\nimport wretch from 'wretch';\r\nimport Moment from 'moment';\r\nimport mapboxgl from 'mapbox-gl'\r\nimport { relative } from 'path';\r\n\r\n\r\nclass SignalsMap extends Component {\r\n  _isMounted = false;\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      items: {},\r\n      isLoading: false\r\n    };\r\n  }\r\n\r\n  async componentDidMount() {\r\n    this._isMounted = true;\r\n    const res = await this.loadSignal();\r\n\r\n    mapboxgl.accessToken = 'pk.eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZGI4MTIzOWRmN2U2ZDRiNjgwZjQyZTEiLCJpYXQiOjE2MDA3Nzk3ODZ9.pmNOT1kl1a-ylGCOudg8JVabUOAuW3gRjuh2zSCmruQ';\r\n\r\n    var map = new mapboxgl.Map({\r\n      container: this.Mapcontainer,\r\n      style: 'mapbox://styles/mapbox/streets-v9',\r\n      center: [2.4159, 48.7651],\r\n      zoom: 13\r\n    });\r\n\r\n    map.on(\"load\", function () {\r\n          map.loadImage(\"https://i.imgur.com/MK4NUzI.png\", async function(error, image) {\r\n          if (error) throw error;\r\n          await res.forEach(\r\n            sig => {\r\n            map.addImage(sig._id, image);\r\n            map.addLayer({\r\n              id: sig._id,\r\n              type: \"symbol\",\r\n              source: {\r\n                type: \"geojson\",\r\n                data: {\r\n                  type: 'FeatureCollection',\r\n                  features: [\r\n                    {\r\n                      type: 'Feature',\r\n                      properties: {\r\n                        \"description\":\"<strong>\"+ sig.name +\"</strong><p>\"+\r\n                        sig.description + \"</p> <p>Date: \"+ Moment(sig.created_date).format('DD/MM/YY Ã  HH:mm') +\r\n                        \"</p> <p><a href='\"+ `/signal/${sig._id}/` +\"'><em>Voir la fiche du signalement</em></a> </p>\"\r\n                      },\r\n                      geometry: {\r\n                      type: \"Point\",\r\n                      coordinates: [sig.localization.long, sig.localization.lat]\r\n                      }\r\n                    }\r\n                  ]\r\n                }\r\n              },\r\n              layout: {\r\n                \"icon-image\": sig._id,\r\n                \"icon-allow-overlap\": true\r\n              }\r\n            });\r\n            map.on('click', sig._id, function (e) {\r\n              var coordinates = e.features[0].geometry.coordinates.slice();\r\n              var description = e.features[0].properties.description;\r\n              while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {\r\n              coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;\r\n              }\r\n              new mapboxgl.Popup()\r\n              .setLngLat(coordinates)\r\n              .setHTML(description)\r\n              .addTo(map);\r\n              });\r\n            }\r\n          );\r\n        })\r\n      });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this._isMounted = false;\r\n  }\r\n\r\n  async componentDidUpdate(prevProps, prevState, snapshot) {\r\n    if (prevProps.match.params.id !== this.props.match.params.id)\r\n      await this.loadSignal()\r\n  }\r\n\r\n  loadSignal = async () => {\r\n    return new Promise((resolve, reject) => {\r\n      if (this._isMounted)\r\n        this.setState({\r\n          isLoading: true\r\n        });\r\n      wretch()\r\n        .auth(`Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZGI4MTIzOWRmN2U2ZDRiNjgwZjQyZTEiLCJpYXQiOjE2MDA3Nzk3ODZ9.pmNOT1kl1a-ylGCOudg8JVabUOAuW3gRjuh2zSCmruQ`)\r\n        .url(`http://localhost:8080/signal`)\r\n        .get()\r\n        .json(res => {\r\n          if (this._isMounted)\r\n           this.setState({\r\n            isLoading: false,\r\n            items: res,\r\n          });\r\n          resolve(res)\r\n        })\r\n        .catch(err => {\r\n          console.log('err', err);\r\n          reject()\r\n        })\r\n    })\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"animated fadeIn\">\r\n        <Row>\r\n          <Col lg={12}>\r\n            <Card>\r\n              <CardHeader className=\"card card-accent-warning mb-3\" >\r\n                <strong><i className=\"icon-info pr-1\"></i>Localisation</strong>\r\n              </CardHeader>\r\n              <CardBody>\r\n              <div className='FullMap' ref={(x) => { this.Mapcontainer = x }}></div>\r\n              </CardBody>\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default SignalsMap;\r\n"]},"metadata":{},"sourceType":"module"}