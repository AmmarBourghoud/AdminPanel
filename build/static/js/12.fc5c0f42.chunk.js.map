{"version":3,"sources":["../node_modules/reactstrap/es/Table.js","views/Signals/Signal.js"],"names":["propTypes","className","PropTypes","string","cssModule","object","size","bordered","bool","borderless","striped","dark","hover","responsive","oneOfType","tag","tagPropType","responsiveTag","innerRef","func","Table","props","Tag","ResponsiveTag","attributes","_objectWithoutPropertiesLoose","classes","mapToCssModules","classNames","table","React","createElement","_extends","ref","responsiveClassName","defaultProps","Signal","_isMounted","loadSignal","a","Promise","resolve","reject","setState","isLoading","wretch","url","match","params","id","get","notFound","history","push","console","log","json","res","author","resUser","user","item","catch","err","state","this","mapboxgl","accessToken","map","Map","container","Mapcontainer","style","center","zoom","on","loadImage","error","image","addImage","addLayer","type","source","data","features","properties","geometry","coordinates","layout","prevProps","prevState","snapshot","signal","lg","_id","name","category","description","city","status","Moment","date","format","created_date","last_update","x","scope","key","gender","firstName","lastName","email","phone","Component"],"mappings":"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","file":"static/js/12.fc5c0f42.chunk.js","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { mapToCssModules, tagPropType } from './utils';\nvar propTypes = {\n  className: PropTypes.string,\n  cssModule: PropTypes.object,\n  size: PropTypes.string,\n  bordered: PropTypes.bool,\n  borderless: PropTypes.bool,\n  striped: PropTypes.bool,\n  dark: PropTypes.bool,\n  hover: PropTypes.bool,\n  responsive: PropTypes.oneOfType([PropTypes.bool, PropTypes.string]),\n  tag: tagPropType,\n  responsiveTag: tagPropType,\n  innerRef: PropTypes.oneOfType([PropTypes.func, PropTypes.string, PropTypes.object])\n};\nvar defaultProps = {\n  tag: 'table',\n  responsiveTag: 'div'\n};\n\nvar Table = function Table(props) {\n  var className = props.className,\n      cssModule = props.cssModule,\n      size = props.size,\n      bordered = props.bordered,\n      borderless = props.borderless,\n      striped = props.striped,\n      dark = props.dark,\n      hover = props.hover,\n      responsive = props.responsive,\n      Tag = props.tag,\n      ResponsiveTag = props.responsiveTag,\n      innerRef = props.innerRef,\n      attributes = _objectWithoutPropertiesLoose(props, [\"className\", \"cssModule\", \"size\", \"bordered\", \"borderless\", \"striped\", \"dark\", \"hover\", \"responsive\", \"tag\", \"responsiveTag\", \"innerRef\"]);\n\n  var classes = mapToCssModules(classNames(className, 'table', size ? 'table-' + size : false, bordered ? 'table-bordered' : false, borderless ? 'table-borderless' : false, striped ? 'table-striped' : false, dark ? 'table-dark' : false, hover ? 'table-hover' : false), cssModule);\n  var table = React.createElement(Tag, _extends({}, attributes, {\n    ref: innerRef,\n    className: classes\n  }));\n\n  if (responsive) {\n    var responsiveClassName = mapToCssModules(responsive === true ? 'table-responsive' : \"table-responsive-\" + responsive, cssModule);\n    return React.createElement(ResponsiveTag, {\n      className: responsiveClassName\n    }, table);\n  }\n\n  return table;\n};\n\nTable.propTypes = propTypes;\nTable.defaultProps = defaultProps;\nexport default Table;","\r\nimport React, { Component } from 'react';\r\nimport {Badge, Card, CardBody, CardHeader, Col, Row, Table} from 'reactstrap';\r\nimport wretch from 'wretch';\r\nimport Moment from 'moment';\r\nimport mapboxgl from 'mapbox-gl'\r\nimport { relative } from 'path';\r\n\r\n\r\n\r\nclass Signal extends Component {\r\n  _isMounted = false;\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      item: {},\r\n      user: {},\r\n      isLoading: false\r\n    };\r\n  }\r\n\r\n  async componentDidMount() {\r\n    this._isMounted = true;\r\n    await this.loadSignal();\r\n\r\n    mapboxgl.accessToken = 'pk.eyJ1IjoiY2VjZW5uYmwiLCJhIjoiY2szNGo3MHhxMDlqbTNwbzRtM2JnMG9iMiJ9.jPHdv3qcnvmAqe69UlA8LQ';\r\n\r\n    var map = new mapboxgl.Map({\r\n      container: this.Mapcontainer,\r\n      style: 'mapbox://styles/mapbox/streets-v9',\r\n      center: [2.4159, 48.7651],\r\n      zoom: 16\r\n    });\r\n\r\n    map.on(\"load\", function () {\r\n      map.loadImage(\"https://i.imgur.com/MK4NUzI.png\", function(error, image) {\r\n        if (error) throw error;\r\n        map.addImage(\"custom-marker\", image);\r\n        map.addLayer({\r\n          id: \"markers\",\r\n          type: \"symbol\",\r\n          source: {\r\n            type: \"geojson\",\r\n            data: {\r\n              type: 'FeatureCollection',\r\n              features: [\r\n                {\r\n                  type: 'Feature',\r\n                  properties: {},\r\n                  geometry: {\r\n                  type: \"Point\",\r\n                  coordinates: [2.4162, 48.7649]\r\n                  }\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          layout: {\r\n            \"icon-image\": \"custom-marker\",\r\n          }\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this._isMounted = false;\r\n  }\r\n\r\n  async componentDidUpdate(prevProps, prevState, snapshot) {\r\n    if (prevProps.match.params.id !== this.props.match.params.id)\r\n      await this.loadSignal()\r\n  }\r\n\r\n  loadSignal = async () => {\r\n    return new Promise((resolve, reject) => {\r\n      if (this._isMounted)\r\n        this.setState({\r\n          isLoading: true\r\n        });\r\n      wretch()\r\n        .url(`http://localhost:8080/signal/${this.props.match.params.id}`)\r\n        .get()\r\n        .notFound(() => {\r\n          this.props.history.push('/signal');\r\n          console.log('notFound');\r\n          reject()\r\n        })\r\n        .json(res => {\r\n          console.log('res', res)\r\n          wretch()\r\n            .url(`http://localhost:8080/user/${res.author}`)\r\n            .get()\r\n            .json(resUser => {\r\n              if (this._isMounted)\r\n              this.setState({\r\n                user: resUser,\r\n              });\r\n            });\r\n          if (this._isMounted)\r\n          this.setState({\r\n            isLoading: false,\r\n            item: res,\r\n          });\r\n          resolve()\r\n        })\r\n        .catch(err => {\r\n          console.log('err', err);\r\n          reject()\r\n        })\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const {item: signal, isLoading, user: user} = this.state\r\n\r\n    if (isLoading) return null\r\n\r\n    console.log('signal', signal)\r\n\r\n    return (\r\n      <div className=\"animated fadeIn\">\r\n        <Row>\r\n          <div className=\"divSameHeight\">\r\n            <Col lg={6} className=\"sameHeight\">\r\n              <Card  className=\"fullHeight\">\r\n                <CardHeader className=\"card card-accent-primary mb-3\">\r\n                  <strong><i className=\"icon-info pr-1\"></i>Signalement</strong>\r\n                </CardHeader>\r\n                <CardBody>\r\n                  <Table responsive striped hover>\r\n                    <tbody>\r\n                    {/*<tr>*/}\r\n                      <tr>\r\n                        <th>id</th>\r\n                        <td>{signal._id}</td>\r\n                      </tr>\r\n                      <tr>\r\n                        <th>Nom</th>\r\n                        <td>{signal.name }</td>\r\n                      </tr>\r\n                      <tr>\r\n                        <th>Catégorie</th>\r\n                        <td>{signal.category}</td>\r\n                      </tr>\r\n                      <tr>\r\n                        <th>Description</th>\r\n                        <td>{signal.description}</td>\r\n                      </tr>\r\n                      <tr>\r\n                        <th>Ville</th>\r\n                        <td>{signal.city}</td>\r\n                      </tr>\r\n                      <tr>\r\n                        <th>Status</th>\r\n                        <td>{signal.status}</td>\r\n                      </tr>\r\n                      <tr>\r\n                        <th>Date</th>\r\n                        <td>{Moment(signal.date).format('DD/MM/YY à HH:mm')}</td>\r\n                      </tr>\r\n                      <tr>\r\n                        <th>Date de création</th>\r\n                        <td>{Moment(signal.created_date).format('DD/MM/YY à HH:mm')}</td>\r\n                      </tr>\r\n                      <tr>\r\n                        <th>Dernière mis à jour</th>\r\n                        <td>{Moment(signal.last_update).format('DD/MM/YY à HH:mm')}</td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </Table>\r\n                </CardBody>\r\n              </Card>\r\n            </Col>\r\n\r\n            <Col lg={6}  className=\"sameHeight\">\r\n              <Card className=\"fullHeight\">\r\n                <CardHeader className=\"card card-accent-warning mb-3\" >\r\n                  <strong><i className=\"icon-info pr-1\"></i>Localisation</strong>\r\n                </CardHeader>\r\n                <CardBody >\r\n                <div className='MapContent' ref={(x) => { this.Mapcontainer = x }}></div>\r\n                </CardBody>\r\n              </Card>\r\n            </Col>\r\n          </div>\r\n\r\n          <Col lg={12}>\r\n            <Card>\r\n              <CardHeader className=\"card card-accent-success mb-3\">\r\n                <strong><i className=\"icon-info pr-1\"></i>Auteur du signalement</strong>\r\n              </CardHeader>\r\n              <CardBody>\r\n                <Table responsive striped hover>\r\n                  <thead>\r\n                  <tr>\r\n                    <th scope=\"col\">Civilité</th>\r\n                    <th scope=\"col\">Nom</th>\r\n                    <th scope=\"col\">Email</th>\r\n                    <th scope=\"col\">Numéro de téléphone</th>\r\n                  </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    <tr key={user._id}>\r\n                      <td>{user.gender}</td>\r\n                      <td><strong>{`${user.firstName} ${user.lastName}`}</strong></td>\r\n                      <td>{user.email}</td>\r\n                      <td>{user.phone}</td>\r\n                    </tr>\r\n                  </tbody>\r\n                </Table>\r\n              </CardBody>\r\n            </Card>\r\n          </Col>\r\n        </Row>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Signal;\r\n"],"sourceRoot":""}